{% extends 'core/base.html' %}
{% block content %}

<div class="container py-4">
  <div class="card shadow-sm p-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="mb-0">Question {{ question_number }} of {{ total_questions }}</h4>
      <div class="alert alert-warning py-2 px-3 mb-0" id="timer" style="font-size: 16px;">
        Time Left: 01:00
      </div>
    </div>

    <p class="lead">{{ question.text }}</p>

    <form method="post" id="quiz-form">
      {% csrf_token %}

      {% for option in options %}
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="option" id="option{{ option.id }}" value="{{ option.id }}" required>
          <label class="form-check-label" for="option{{ option.id }}">
            {{ option.text }}
          </label>
        </div>
      {% endfor %}

      <hr>
      <button type="submit" class="btn btn-primary w-100 py-2 fs-5" id="submit-btn">Submit Answer</button>
    </form>
  </div>
</div>

<!-- Timer Script -->
<script>
  let timeLeft = 60; // seconds
  const timerEl = document.getElementById("timer");
  const form = document.getElementById("quiz-form");
  const submitBtn = document.getElementById("submit-btn");

  function updateTimer() {
    let mins = Math.floor(timeLeft / 60);
    let secs = timeLeft % 60;
    timerEl.innerText = `Time Left: ${mins}:${secs < 10 ? '0' : ''}${secs}`;

    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      submitBtn.disabled = true;
      form.submit();  // auto-submit
    }

    timeLeft--;
  }

  const timerInterval = setInterval(updateTimer, 1000);
</script>

{% endblock %}
